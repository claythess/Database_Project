<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Profile - Movie Application</title>
<style>
body {
    background-color: black;
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    color: white;
}

.header {
    text-align: center;
    padding: 20px;
    position: relative;
}

.logo {
    max-width: 500px;
    width: 100%;
    height: auto;
}

.logout-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    padding: 10px 20px;
    background-color: #2a2a2a;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
}

.logout-btn:hover {
    background-color: #3a3a3a;
}

.main-container {
    display: flex;
    padding: 20px;
    gap: 20px;
}

.sidebar {
    width: 80px;
    display: flex;
    flex-direction: column;
    gap: 30px;
    padding-top: 20px;
}

.star-icon {
    width: 60px;
    height: 60px;
    cursor: pointer;
    transition: transform 0.2s;
}

.star-icon:hover {
    transform: scale(1.1);
}

.content {
    flex: 1;
    padding-left: 40px;
}

.profile-section {
    margin-bottom: 40px;
}

.profile-section h2 {
    font-size: 24px;
    margin-bottom: 15px;
    text-transform: uppercase;
}

.reviews-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 20px;
}

.review-box {
    background-color: #1a1a1a;
    padding: 20px;
    border-radius: 8px;
    min-height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.koala-corner {
    position: fixed;
    bottom: 20px;
    right: 20px;
    max-width: 150px;
    width: 100%;
    height: auto;
}
</style>
</head>
<body>
<div class="header">
    <button class="logout-btn" onclick="window.location.href='/'">Logout</button>
    <img src="{{ url_for('static', filename='logo.png') }}" alt="Sick Movie Application" class="logo">
</div>

<div style="text-align:center;padding:10px;">
    <form action="/search" method="POST" style="display:inline-block;">
        <input type="text" name="title" placeholder="Search movies by title" style="padding:8px;border-radius:4px;border:1px solid #333;background:#111;color:white;"> 
        <input type="text" name="year" placeholder="Year (optional)" style="padding:8px;border-radius:4px;border:1px solid #333;background:#111;color:white;margin-left:5px;"> 
        <button type="submit" class="logout-btn" style="position:static;display:inline-block;margin-left:10px;padding:8px 12px;">Search</button>
    </form>
</div>

<div class="main-container">
    <div class="sidebar">
        <img src="{{ url_for('static', filename='stars.png') }}" alt="Star" class="star-icon">
        <img src="{{ url_for('static', filename='stars.png') }}" alt="Star" class="star-icon">
        <img src="{{ url_for('static', filename='stars.png') }}" alt="Star" class="star-icon">
    </div>

    <div class="content">
        <div class="profile-section">
            <h2>People</h2>
            <form action="/user_search" method="POST" style="margin-bottom:12px;">
                <input type="text" name="username" placeholder="Search users by name" style="padding:8px;border-radius:4px;border:1px solid #333;background:#111;color:white;">
                <button type="submit" class="logout-btn" style="position:static;display:inline-block;margin-left:8px;padding:8px 12px;">Search Users</button>
            </form>
            <div style="margin-top:8px">
                <strong>Following:</strong>
                {% if followees and followees|length > 0 %}
                    {% for u in followees %}
                        <a href="{{ url_for('user_profile', username=u) }}" style="color:#fff;margin-left:8px">{{ u }}</a>
                    {% endfor %}
                {% else %}
                    <span style="margin-left:8px">—</span>
                {% endif %}
            </div>
            <div style="margin-top:8px">
                <strong>Followers:</strong>
                {% if followers and followers|length > 0 %}
                    {% for u in followers %}
                        <a href="{{ url_for('user_profile', username=u) }}" style="color:#fff;margin-left:8px">{{ u }}</a>
                    {% endfor %}
                {% else %}
                    <span style="margin-left:8px">—</span>
                {% endif %}
            </div>
        </div>
        <div class="profile-section">
            <h2>{{ username or 'My Profile' }}</h2>
        </div>

        <div class="profile-section">
            <h2>Favorites</h2>
            <div style="margin-bottom:12px">
                <strong>Actor:</strong>
                {% if favorite_actor %}
                    <a href="{{ url_for('actor_view', actor_id=favorite_actor.id) }}" style="color:#ffd700;text-decoration:none">{{ favorite_actor.name }}</a>
                {% else %}
                    <span>—</span>
                {% endif %}
            </div>
            <div style="margin-bottom:12px">
                <strong>Director:</strong>
                {% if favorite_director %}
                    <a href="{{ url_for('director_view', director_id=favorite_director.id) }}" style="color:#ffd700;text-decoration:none">{{ favorite_director.name }}</a>
                {% else %}
                    <span>—</span>
                {% endif %}
            </div>

            <form action="/set_favorite_actor" method="post" style="margin-top:8px;">
                <input type="text" name="actor" placeholder="Set favorite actor (name)" style="padding:8px;border-radius:4px;border:1px solid #333;background:#111;color:white;">
                <button type="submit" class="logout-btn" style="position:static;display:inline-block;margin-left:8px;padding:8px 12px;">Set Actor</button>
            </form>

            <form action="/set_favorite_director" method="post" style="margin-top:8px;">
                <input type="text" name="director" placeholder="Set favorite director (name)" style="padding:8px;border-radius:4px;border:1px solid #333;background:#111;color:white;">
                <button type="submit" class="logout-btn" style="position:static;display:inline-block;margin-left:8px;padding:8px 12px;">Set Director</button>
            </form>
        </div>

        <div class="profile-section">
            <h2>Recent Reviews</h2>
            <div class="reviews-grid">
                {% if reviews and reviews|length > 0 %}
                    {% for r in reviews %}
                        <div class="review-box" style="align-items:flex-start;justify-content:flex-start;">
                            <div>
                                <div style="font-weight:bold;margin-bottom:6px;">
                                    {% if r.movie %}
                                        <a href="{{ url_for('movie_view', movie_id=r.movie['id']) }}" style="color:#fff;text-decoration:none">{{ r.movie['title'] }}</a>
                                        ({{ r.movie['year'] if r.movie and r.movie['year'] else '' }})
                                    {% else %}
                                        Unknown Movie
                                    {% endif %}
                                </div>
                                <div style="color:#ffd700;margin-bottom:6px;">Rating: {{ r['rating'] }}</div>
                                <div style="margin-bottom:8px;">{{ r['review'] }}</div>
                                {% if r.get('created_at') %}
                                    <div style="font-size:12px;color:#888;">{{ r['created_at'] }}</div>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="review-box">No reviews yet.</div>
                {% endif %}
            </div>
        </div>

        <!-- Removed 'Listed Like This' placeholder sections -->
    </div>
</div>

<img src="{{ url_for('static', filename='koala.png') }}" alt="Koala" class="koala-corner" onclick="playLaugh()" style="cursor: pointer;">

<audio id="laughSound">
    <source src="{{ url_for('static', filename='laugh.wav') }}" type="audio/mpeg">
</audio>

<script>
function playLaugh() {
    var audio = document.getElementById('laughSound');
    audio.play();
}
</script>
</body>
</html>